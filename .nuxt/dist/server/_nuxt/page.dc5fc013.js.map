{"version":3,"file":"page.dc5fc013.js","sources":["../../../../layouts/page.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport QrcodeVue from 'qrcode.vue'\nimport { useCart } from '~/stores/cart'\nimport { useLoading } from '~/stores/loading'\nimport { IApp } from '~/utils/app'\nimport { Api } from '~~/services/api'\nimport { Transaction } from '~/type'\n\n// state\nconst app = useState<IApp>('app')\n\n// composables\nconst cart = useCart()\nconst loading = useLoading()\nconst api = useApi()\n\n// funcs\nconst { reset, increment, decrement } = cart\n\n// modal checkout\nconst isShowModalCheckout = ref(false)\nconst toggleCheckout = () => {\n  isShowModalCheckout.value = !isShowModalCheckout.value\n}\n\n// checkout\nconst transaction = ref<Transaction | undefined>()\nconst ticketElm = ref<HTMLDivElement>()\nconst ticketElmRotate = ref({\n  x: 0,\n  y: 0,\n})\nconst isCheckoutSuccess = ref(false)\nconst checkout = async () => {\n  loading.show()\n\n  await new Promise((resolve) => setTimeout(resolve, 2000))\n\n  try {\n    const res = await api.create(\n      Api.Transaction.Create({\n        user_name: 'guest',\n        menus: [\n          ...cart.menus.map((menu) => ({\n            id: menu.menu.id,\n            qty: menu.quantity,\n          })),\n        ],\n      })\n    )\n    if (res.status === 201) {\n      transaction.value = res.data.data\n      isCheckoutSuccess.value = true\n      reset()\n    }\n  } catch (error) {}\n\n  loading.hide()\n}\nconst close = () => {\n  isCheckoutSuccess.value = false\n  toggleCheckout()\n}\nconst onMouseMove = function (e: { clientY: number; clientX: number }) {\n  if (ticketElm.value && isCheckoutSuccess.value) {\n    const { x, y, width, height } = ticketElm.value.getBoundingClientRect()\n    const centerPoint = { x: x + width / 2, y: y + height / 2 }\n    const rotateX = (e.clientY - centerPoint.y) * 0.008\n    const rotateY = (e.clientX - centerPoint.x) * -0.008\n    ticketElmRotate.value = { x: rotateX, y: rotateY }\n  }\n}\n\n// lifecycle\nonMounted(() => {\n  document.addEventListener('mousemove', onMouseMove)\n})\nonBeforeUnmount(() => {\n  document.removeEventListener('mousemove', onMouseMove)\n})\n</script>\n\n<template>\n  <div>\n    <slot name=\"app-before\" />\n    <div id=\"app-before\"></div>\n    <div class=\"flex flex-col min-h-screen\">\n      <slot name=\"header\">\n        <PageNavbar />\n      </slot>\n      <div class=\"flex-1 w-full flex flex-col\">\n        <div\n          class=\"relative flex-1 flex flex-col mx-auto max-w-8xl w-full h-full\"\n        >\n          <slot />\n        </div>\n      </div>\n      <slot name=\"footer\">\n        <PageFooter />\n      </slot>\n    </div>\n    <slot name=\"app-after\" />\n    <div id=\"app-after\"></div>\n\n    <!-- cart -->\n    <div>\n      <div\n        v-if=\"isShowModalCheckout\"\n        class=\"fixed top-0 left-0 w-screen h-screen z-50 bg-black/80\"\n      />\n      <div\n        class=\"transition-all duration-300 fixed block w-96 z-50\"\n        :class=\"{\n          'bottom-0 right-0 mb-6 mr-6': !isShowModalCheckout,\n        }\"\n        :style=\"`${\n          isShowModalCheckout\n            ? 'top: 50%; left: 50%; transform: translate(-50%, -50%);'\n            : ''\n        }`\"\n      >\n        <div\n          class=\"flex-1 relative bg-slate-800 rounded-lg shadow-xl border border-primary-600\"\n        >\n          <div class=\"text-2xl font-bold px-6 py-4 flex justify-between\">\n            <span>Cart</span>\n            <span\n              v-if=\"isShowModalCheckout\"\n              class=\"transform rotate-45 text-4xl cursor-pointer hover:text-red-500\"\n              @click=\"toggleCheckout\"\n            >\n              +\n            </span>\n          </div>\n          <div class=\"px-6 pb-4 flex flex-col space-y-8\">\n            <div class=\"flex flex-col space-y-1\">\n              <div\n                v-for=\"item in cart.menus\"\n                :key=\"item.menu.id\"\n                class=\"flex justify-between\"\n              >\n                <div class=\"flex items-center\">\n                  <span class=\"mr-2 truncate max-w-full\">{{\n                    item.menu.name\n                  }}</span>\n                  <!-- <span v-if=\"item.quantity > 1\" class=\"text-xs\">\n                    x {{ item.quantity }}\n                  </span> -->\n                  <span class=\"flex space-x-2 text-xs\">\n                    <button\n                      class=\"rounded-full w-5 h-5 flex justify-center items-center bg-slate-700\"\n                      @click=\"decrement(item)\"\n                    >\n                      -\n                    </button>\n                    <div>{{ item.quantity }}</div>\n                    <button\n                      class=\"rounded-full w-5 h-5 flex justify-center items-center bg-slate-700\"\n                      @click=\"increment(item)\"\n                    >\n                      +\n                    </button>\n                  </span>\n                </div>\n                <div>\n                  {{\n                    $getCurrentCurrency().symbol + cart.getPriceMenuItem(item)\n                  }}\n                </div>\n              </div>\n              <div v-if=\"cart.menus.length === 0\">\n                <div class=\"text-center\">Cart is empty</div>\n              </div>\n            </div>\n            <div v-if=\"!isShowModalCheckout\" class=\"flex space-x-2 justify-end\">\n              <Button size=\"sm\" type=\"danger\" text=\"Reset\" @click=\"reset\" />\n              <Button size=\"sm\" text=\"Checkout\" @click=\"toggleCheckout\" />\n            </div>\n            <div v-else class=\"flex space-x-2 justify-end\">\n              <Button\n                size=\"sm\"\n                type=\"danger\"\n                text=\"Cancel\"\n                @click=\"toggleCheckout\"\n              />\n              <Button size=\"sm\" text=\"Checkout Now\" @click=\"checkout\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- checkout -->\n    <div\n      v-if=\"isCheckoutSuccess && transaction\"\n      class=\"fixed top-0 left-0 flex w-screen h-screen z-50 bg-primary-600\"\n    >\n      <div\n        class=\"flex-1 relative flex flex-col justify-center items-center space-y-8\"\n      >\n        <div class=\"text-4xl font-bold text-center\">\n          YOUR CHECKOUT SUCCESS CREATE!!!\n        </div>\n        <!-- ticket -->\n        <div\n          ref=\"ticketElm\"\n          class=\"w-120 h-50 rounded-lg shadow bg-white text-slate-800 flex px-6 py-4 relative\"\n          :style=\"{\n            transform: `perspective(1000px) rotateX(${ticketElmRotate.x}deg) rotateY(${ticketElmRotate.y}deg)`,\n          }\"\n        >\n          <div class=\"flex-1 flex flex-col justify-between\">\n            <div>\n              <div class=\"font-mono font-bold text-xl\">CHECKOUT TICKET</div>\n              <div class=\"font-semibold\">{{ app.name }}</div>\n            </div>\n            <div class=\"flex flex-col\">\n              <div>\n                <span class=\"font-semibold mr-2\">Name :</span>\n                <span class=\"font-mono\">{{ transaction.user_name }}</span>\n              </div>\n              <div>\n                <span class=\"font-semibold mr-2\">Total :</span>\n                <span>{{ $formatCurrency(transaction.total) }}</span>\n              </div>\n            </div>\n          </div>\n          <div class=\"pr-2 flex mr-4 items-center\">\n            <!-- <img\n              src=\"https://chart.googleapis.com/chart?cht=qr&chl=https%3A%2F%2Fwww.example.com&chs=180x180&choe=UTF-8&chld=L|2\"\n              alt=\"Qrcode\"\n              class=\"inline-block\"\n            /> -->\n            <QrcodeVue :value=\"`#${transaction.code}`\" :size=\"142\" level=\"H\" />\n          </div>\n          <div\n            class=\"absolute right-0 transform mr-7 font-bold font-mono text-gray-600\"\n            :style=\"{\n              top: '50%',\n              transform: 'translate(50%, -50%) rotate(90deg)',\n            }\"\n          >\n            #{{ transaction.code }}\n          </div>\n        </div>\n        <div>\n          <Button size=\"sm\" text=\"Back to Catalog\" @click=\"close\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AASA,UAAA,MAAA,SAAA,KAAA;AAGA,UAAA,OAAA;AACA,UAAA,UAAA;AACA,UAAA,MAAA;AAGA,UAAA,EAAA,OAAA,WAAA,UAAA,IAAA;AAGA,UAAA,sBAAA,IAAA,KAAA;AACA,UAAA,iBAAA,MAAA;AACE,0BAAA,QAAA,CAAA,oBAAA;AAAA,IAAiD;AAInD,UAAA,cAAA;AACA,QAAA;AACA,UAAA,kBAAA,IAAA;AAAA,MAA4B,GAAA;AAAA,MACvB,GAAA;AAAA,IACA,CAAA;AAEL,UAAA,oBAAA,IAAA,KAAA;AACA,UAAA,WAAA,YAAA;AACE,cAAA,KAAA;AAEA,YAAA,IAAA,QAAA,CAAA,YAAA,WAAA,SAAA,GAAA,CAAA;AAEA,UAAA;AACE,cAAA,MAAA,MAAA,IAAA;AAAA,UAAsB,IAAA,YAAA,OAAA;AAAA,YACG,WAAA;AAAA,YACV,OAAA;AAAA,cACJ,GAAA,KAAA,MAAA,IAAA,CAAA,UAAA;AAAA,gBACwB,IAAA,KAAA,KAAA;AAAA,gBACb,KAAA,KAAA;AAAA,cACJ,EAAA;AAAA,YACV;AAAA,UACJ,CAAA;AAAA,QACD;AAEH,YAAA,IAAA,WAAA,KAAA;AACE,sBAAA,QAAA,IAAA,KAAA;AACA,4BAAA,QAAA;AACA;QAAM;AAAA,MACR,SAAA,OAAA;AAAA,MACA;AAEF,cAAA,KAAA;AAAA,IAAa;AAEf,UAAA,QAAA,MAAA;AACE,wBAAA,QAAA;AACA;IAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}